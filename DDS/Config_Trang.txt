1.Bảng Town cần clean data (TownName 1 số dòng thiếu tên và dư  dấu “” → cần làm sạch data)
postcode đổ từ file excel postcode.xls
sẽ thay đổi cấu trúc bảng 
Máy t là nó lỗi với bảng cũ nên phải sửa lại như vậy
CREATE TABLE [dbo].[UKPostcodes](
	[postcode] [NVARCHAR](4) NULL,
	[easting] [INT] NULL,
	[northing] [INT] NULL,
	[latitude] [VARCHAR](10) NULL,
	[longitude] [VARCHAR](10) NULL,
	[city] [NVARCHAR](50) NULL,
	[county] [NVARCHAR](40) NULL,
	[country_code] [NVARCHAR](3) NULL,
	[country_name] [NVARCHAR](30) NULL,
	[iso3166-2] [NVARCHAR](20) NULL,
	[region_code] [NVARCHAR](10) NULL,
	[region_name] [NVARCHAR](40) NULL
) ON [PRIMARY]
GO
Do các thuộc tính ở trên chuyển qua nvarchar nên các thuộc tính khóa ngoại tới cũng phải sửa lại là nvarchar
​
NDS:

CREATE TABLE Country (
	CountryId INT PRIMARY KEY IDENTITY(1,1),
	CountryName NVARCHAR(20) NOT NULL
)
GO
​
CREATE TABLE Region (
	RegionId INT PRIMARY KEY IDENTITY(1, 1),
	RegionName NVARCHAR(30),
	CountryId INT,
​
	CONSTRAINT FK_Region_Country FOREIGN KEY (CountryId)
	REFERENCES dbo.Country(CountryId)
)
GO
​
CREATE TABLE County(
	CountyId INT PRIMARY KEY IDENTITY(1,1),
	CountyName NVARCHAR(30),
	RegionId INT,
​
	CONSTRAINT FK_County_Region FOREIGN KEY (RegionId)
	REFERENCES dbo.Region(RegionId)
)
GO
​
CREATE TABLE Town (
	TownId INT PRIMARY KEY IDENTITY(1, 1),
	TownName NVARCHAR(30),
	CountyId INT,
​
	CONSTRAINT FK_Town_County FOREIGN KEY (CountyId)
	REFERENCES dbo.County (CountyId)
)

DDS:
CREATE TABLE Dim_Country (
	CountryId INT PRIMARY KEY,
	CountryName NVARCHAR(20)
)
GO
​
CREATE TABLE Dim_Region (
	RegionId INT PRIMARY KEY,
	RegionName NVARCHAR(30),
	CountryId INT,
)
GO
​
CREATE TABLE Dim_County(
	CountyId INT PRIMARY KEY IDENTITY(1,1),
	CountyName NVARCHAR(30),
	RegionId INT
)
GO
​
CREATE TABLE Dim_Town (
	TownId INT PRIMARY KEY IDENTITY(1, 1),
	TownName NVARCHAR(30),
	CountyId INT
)
GO 
2. Bảng Town có giá trị null 
Ở NDS: toCity thêm điều kiện where cho câu select 
SELECT DISTINCT city, county FROM UKPostcodes where city IS NOT NULL

3. Thiếu LA code (câu 1, câu 2)
Thêm Bảng LAcode vào
Nên ở Accident NDS cần thêm thuộc tính LACodeId và Khóa ngoại vào

ALTER TABLE [dbo].[Accident]  WITH CHECK ADD  CONSTRAINT [FK_Accident_LACode] FOREIGN KEY([LACodeId])
REFERENCES [dbo].[LACode] ([LACodeId])

Ở Accident_NDS Lookup lấy thêm thuộc tính lsoa11cd
Bước kế cuối có thêm Lookup LACodeId 

Ở DDS thêm Dim_LACode
CREATE TABLE [dbo].[Dim_LACode](
	[LACodeId] [INT] NOT NULL,
	[LACode] [VARCHAR](50) NULL,
PRIMARY KEY CLUSTERED 
(
	[LACodeId] ASC
)WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON, OPTIMIZE_FOR_SEQUENTIAL_KEY = OFF) ON [PRIMARY]
) ON [PRIMARY]
GO


Thêm LACodeId cho 2 bảng Fact Accident và Fact Casualty

Lookup Dim LACode cho 2 bảng Fact trên